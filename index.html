<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLITEKNIK KUCHING SARAWAK REGISTER Form</title>
    <!-- Load Tailwind CSS for modern aesthetics and responsiveness -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Bootstrap 5 CSS for utility classes and structure (especially the modal) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <style>
         /* Custom styles for a polished look */
        body {
            background-color: #f7f9fb;
            font-family: 'Inter', sans-serif;
        }
        .form-card {
            max-width: 800px;
            margin: 3rem auto;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
        }
        .form-control:focus, .form-select:focus {
            border-color: #4f46e5; /* Tailwind indigo-600 */
            box-shadow: 0 0 0 0.25rem rgba(79, 70, 229, 0.25);
        }
        .text-label {
            font-weight: 500;
            color: #333;
        }
        /* Style for the image preview box */
        #imagePreview {
            /* KEMASKINI: Saiz dikecilkan kepada 20px x 20px */
            width: 20px; 
            height: 20px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            object-fit: cover;
            display: none; /* Hide until image is loaded */
        }

        /* UPDATED: Class for container to enable row highlighting on focus */
        .form-row-container {
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }
        .form-row-container:focus-within {
            /* CHANGED TO LIGHT RED HIGHLIGHT */
            background-color: #fef2f2; /* Tailwind red-50 */
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- Main Form Card -->
        <div class="form-card bg-white p-6 md:p-10 shadow-xl">
            <!-- UPDATED: Separate colors for the title lines -->
            <h1 class="text-center text-2xl md:text-3xl font-extrabold mb-8">
                <span class="text-red-800">POLITEKNIK KUCHING SARAWAK</span> <br> 
                <span class="text-gray-700">Student Registration Form</span>
            </h1> 

            <form id="registrationForm" class="space-y-6">

                <!-- Student Image Section - Now includes image preview -->
                <div class="grid grid-cols-1 items-center mb-6">
                    <label class="text-label col-span-1">Student Image:</label>
                    <div class="col-span-2 flex items-center space-x-1 mt-1 md:mt-0">
                        <!-- Image Preview Element -->
                        <img id="imagePreview" src="#" alt="Pratonton Gambar Pelajar" class="shadow-md" />
                        <style>
                            #imagePreview {
                         width: 100px; 
                         height: 100px;
                          border: 3px solid #000000;
                          border-radius: 8px;
                         }
                         </style>
                        
                        
                        <!-- File Input (Hidden) - Added onchange to call previewImage() -->
                        <input type="file" id="studentImage" accept="image/*" class="form-control w-auto" style="display:none;" 
                                onchange="previewImage(event)" />
                        
                        <div class="flex flex-col space-y-1">
                            <button type="button" onclick="document.getElementById('studentImage').click()" 
                                    class="bg-gray-200 text-gray-700 py-1 px-3 rounded-lg border border-gray-300 hover:bg-gray-300 transition duration-150">
                                Browse...
                            </button>
                            <span class="text-xs text-gray-500">(maksima 5 Mb)</span>
                        </div>
                    </div>
                </div>

                <!-- Personal Details Section - Changed to single column -->
                <div class="grid grid-cols-1 gap-y-4 gap-x-6">
                    <!-- Student Name (onChange/onInput for Caps Lock) -->
                    <div>
                        <label for="studentName" class="text-label">Student Name:</label>
                        <input type="text" id="studentName" placeholder="Full Name" required
                               class="form-control rounded-lg"
                               oninput="convertToCaps(this)">
                    </div>

                    <!-- Father's Name (onChange/onInput for Caps Lock) -->
                    <div>
                        <label for="fatherName" class="text-label">Father's Name:</label>
                        <input type="text" id="fatherName" placeholder="Father's Full Name" required
                               class="form-control rounded-lg"
                               oninput="convertToCaps(this)">
                    </div>

                    <!-- Mother's Name (onChange/onInput for Caps Lock) -->
                    <div>
                        <label for="motherName" class="text-label">Mother's Name:</label>
                        <input type="text" id="motherName" placeholder="Mother's Full Name" required
                               class="form-control rounded-lg"
                               oninput="convertToCaps(this)">
                    </div>
                    
                    <!-- Gender -->
                    <div class="flex items-center space-x-6 pt-2">
                        <span class="text-label">Gender:</span>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="male" value="Male" required>
                            <label class="form-check-label" for="male">Male</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="gender" id="female" value="Female">
                            <label class="form-check-label" for="female">Female</label>
                        </div>
                    </div>
                    
                    <!-- Date of Birth -->
                    <div>
                        <label for="dob" class="text-label">Date of Birth:</label>
                        <input type="date" id="dob" placeholder="dd / mm / yyyy" required
                               class="form-control rounded-lg">
                    </div>

                    <!-- Email (onFocus and onBlur) -->
                    <div>
                        <label for="emailInput" class="text-label">E-mail:</label>
                        <input type="email" id="emailInput" placeholder="email@xyz.com" required
                               class="form-control rounded-lg transition duration-300 ease-in-out"
                               onfocus="handleEmailFocus(this)"
                               onblur="handleEmailBlur(this)">
                        <div id="emailFeedback" class="text-sm mt-1"></div>
                    </div>
                    
                    <!-- Level -->
                    <div>
                        <label for="level" class="text-label">Level:</label>
                        <select id="level" class="form-select rounded-lg" required>
                            <option value="">Select Level</option>
                            <option value="PHD">PhD</option>
                            <option value="Masters">Masters</option>
                            <option value="Bachelors">DEGREE</option>
                            <option value="Bachelors">DIPLOMA</option>
                        </select>
                    </div>

                    <!-- Department -->
                    <div>
                        <label for="department" class="text-label">Department:</label>
                        <select id="department" class="form-select rounded-lg" required>
                            <option value="">Select Department</option>
                            <option value="JABATAN TEKNOLOGI MAKLUMAT DAN KOMUNIKASI">JABATAN TEKNOLOGI DAN KOMUNIKASI</option>
                            <option value="JABATAN KEJURUTERAAN ELEKTRIK">JABATAN KEJURUTERAAN ELEKTRIK</option>
                            <option value="JABATAN PERDAGANGAN">JABATAN PERDAGANGAN</option>
                            <option value="JABATAN KEJURUTERAAN PETROKIMIA">JABATAN KEJURUTERAAN PETROKIMIA</option>
                        </select>
                    </div>

                    <!-- Tel/Mobile -->
                    <div>
                        <label for="telMobile" class="text-label">Tel/Mobile:</label>
                        <input type="tel" id="telMobile" placeholder="0 X XXX XXXX" required
                               class="form-control rounded-lg">
                    </div>

                </div>

                <!-- Address Section - Changed to single column -->
                <div class="mt-8 pt-4 border-t border-gray-200">
                    <h2 class="text-xl font-semibold mb-4 text-gray-700 text-center">Address</h2>
                    <div class="grid grid-cols-1 gap-y-4 gap-x-6">
                        <!-- State -->
                        <div>
                            <label for="state" class="text-label">State:</label>
                            <input type="text" id="state" placeholder="State" required
                                   class="form-control rounded-lg">
                        </div>
                        <!-- City -->
                        <div>
                            <label for="city" class="text-label">City:</label>
                            <input type="text" id="city" placeholder="City" required
                                   class="form-control rounded-lg">
                        </div>
                        <!-- Postcode -->
                        <div>
                            <label for="postcode" class="text-label">Postcode:</label>
                            <input type="text" id="postcode" placeholder="Postcode" required
                                   class="form-control rounded-lg">
                        </div>
                    </div>
                </div>
<!-- Action Buttons -->
                <div class="flex justify-center space-x-4 mt-8 pt-4 border-t border-gray-200">
                    <button type="submit" id="registerBtn"
                            class="btn bg-green-600 text-white hover:bg-green-700 py-2 px-6 rounded-lg shadow-md transition duration-200 font-semibold"
                            onclick="handleSubmit(event)">
                        Register
                    </button>
                    <button type="reset"
                            class="btn bg-red-500 text-white hover:bg-red-600 py-2 px-6 rounded-lg shadow-md transition duration-200 font-semibold">
                        Reset
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bootstrap Modal for Successful Submission (Requirement iv) -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-xl shadow-2xl">
          <div class="modal-header bg-green-500 text-white border-0 rounded-t-xl">
            <h5 class="modal-title font-bold" id="successModalLabel">Submission Successful!</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center p-6">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-500 mx-auto mb-4" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <p class="text-xl font-medium text-gray-700">Your details have been saved!</p>
          </div>
          <div class="modal-footer justify-content-center border-0 p-4">
            <button type="button" class="btn bg-indigo-600 text-white hover:bg-indigo-700 rounded-lg" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
   

    <!-- Bootstrap 5 JS and Popper (required for modal functionality) -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" xintegrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/A+0n1TjJ4Vd8zX54j4K1J1FvG4" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" xintegrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavp+rL/O4GfF1y9M9T+J7t6eP3E4G4" crossorigin="anonymous"></script>

    <script>
        // --- Fungsi untuk Pratonton Gambar (Baru) ---
        function previewImage(event) {
            const imagePreview = document.getElementById('imagePreview');
            const file = event.target.files[0];
            
            if (file) {
                // Check file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('Saiz fail melebihi 5MB. Sila pilih fail yang lebih kecil.');
                    event.target.value = ''; // Clear the file input
                    imagePreview.src = '#';
                    imagePreview.style.display = 'none';
                    return;
                }

                // Use FileReader to read the file contents
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block'; // Show the image preview
                };
                reader.readAsDataURL(file);
            } else {
                imagePreview.src = '#';
                imagePreview.style.display = 'none';
            }
        }

        // --- Requirement (iii): onChange/onInput for Caps Lock ---
        function convertToCaps(inputElement) {
            // Converts the value of the input field to uppercase in real-time
            inputElement.value = inputElement.value.toUpperCase();
        }

        // --- Requirement (ii): onFocus for text field (email) ---
        function handleEmailFocus(inputElement) {
            // Visually highlights the email input field when focused
            inputElement.classList.add('border-2', 'border-indigo-500', 'bg-indigo-50');
            document.getElementById('emailFeedback').innerHTML = '<span class="text-indigo-600">Enter a valid email address.</span>';
        }

        // --- Requirement (i): onBlur ---
        function handleEmailBlur(inputElement) {
            // Removes focus styles and performs simple validation on blur
            inputElement.classList.remove('border-2', 'border-indigo-500', 'bg-indigo-50');
            const feedbackElement = document.getElementById('emailFeedback');
            
            const email = inputElement.value;
            // Simple regex for email pattern check
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; 

            if (email === "") {
                inputElement.classList.remove('is-valid', 'is-invalid');
                feedbackElement.innerHTML = '';
            } else if (emailRegex.test(email)) {
                inputElement.classList.add('is-valid');
                inputElement.classList.remove('is-invalid');
                feedbackElement.innerHTML = '<span class="text-green-600">Email format is valid.</span>';
            } else {
                inputElement.classList.add('is-invalid');
                inputElement.classList.remove('is-valid');
                feedbackElement.innerHTML = '<span class="text-red-600">Invalid email format!</span>';
            }
        }
        
        // --- Requirement (iv): Upon submission, use modal bootstrap ---
        function handleSubmit(event) {
            event.preventDefault(); // Stop the form from submitting normally
            const form = document.getElementById('registrationForm');

            // Check if the form is valid using HTML5 validation
            if (form.checkValidity()) {
                // If valid, show the Bootstrap modal
                const successModal = new bootstrap.Modal(document.getElementById('successModal'));
                successModal.show();
                
                // Optional: Clear the form after success, or just show the modal
                // form.reset(); 
            } else {
                // If invalid, trigger the browser's default validation messages
                form.classList.add('was-validated');
            }
        }

        // Set up the Firebase globals as required by the environment (using no-op for this task)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // Note: For this non-storage task, we don't need to initialize Firebase, 
        // but the variables are included as per standard requirements.

    </script>
</body>
</html>
